<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>문서 허브</title>
  <style>
    :root { --bd:#e5e7eb; --muted:#6b7280; --bg:#fff; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:#111;background:#fff}
    .top{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--bd);padding:10px 16px;z-index:10}
    .top a{color:#0b57d0;text-decoration:none}
    .layout{display:grid;grid-template-columns:320px 1fr;min-height:calc(100vh - 48px)}
    .left{border-right:1px solid var(--bd);padding:14px;overflow:auto}
    .right{padding:20px;max-width:980px}
    .group{margin-bottom:16px}
    .group h3{margin:8px 0;font-size:15px}
    .file{display:block;padding:6px 8px;border-radius:8px;color:#0b57d0;text-decoration:none;font-size:14px}
    .file:hover{background:#f3f4f6}
    .file.active{background:#eaf2ff;color:#0a3f9e;font-weight:600}
    .toc{border:1px solid var(--bd);border-radius:10px;padding:10px 12px;margin-bottom:16px;background:#fafafa}
    .toc h4{margin:0 0 8px 0}
    .toc a{display:block;color:#374151;text-decoration:none;font-size:14px;padding:2px 0}
    .meta{font-size:13px;color:var(--muted);margin-bottom:10px}
    article{line-height:1.7}
    article h1,article h2,article h3{line-height:1.3;scroll-margin-top:70px}
    article pre{background:#0f172a;color:#e2e8f0;padding:12px;border-radius:8px;overflow:auto}
    article code{background:#f3f4f6;padding:2px 6px;border-radius:6px}
    article pre code{background:transparent;padding:0}
    article blockquote{border-left:4px solid #ddd;padding-left:12px;color:#444}
    .empty{color:var(--muted)}
    @media (max-width:900px){.layout{grid-template-columns:1fr}.left{border-right:none;border-bottom:1px solid var(--bd)}}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="top"><a href="/">← 홈</a> · 문서 허브</div>
  <div class="layout">
    <aside class="left" id="nav"></aside>
    <main class="right">
      <div class="meta" id="meta">문서를 선택하세요.</div>
      <div class="toc" id="toc" style="display:none"></div>
      <article id="content" class="empty">왼쪽에서 문서를 선택하면 목차 + 본문이 한 페이지에 표시됩니다.</article>
    </main>
  </div>

<script>
const docs = {
  "Bogle Ops": [
    "/projects/bogle-ops/README.md",
    "/projects/bogle-ops/investing-system.md",
    "/projects/bogle-ops/cafe-ops-manual.md",
    "/projects/bogle-ops/templates.md",
    "/projects/bogle-ops/index-investing-top10.md",
    "/projects/bogle-ops/4week-series-pack.md",
    "/projects/bogle-ops/post-template.md",
    "/projects/bogle-ops/week1-posts-final.md",
    "/projects/bogle-ops/week2-posts-final.md",
    "/projects/bogle-ops/week3-posts-final.md",
    "/projects/bogle-ops/week4-posts-final.md",
    "/projects/bogle-ops/publishing-ops-checklist.md",
    "/projects/bogle-ops/kr-etf-report.md",
    "/projects/bogle-ops/kr-etf-report-v2.md",
    "/projects/bogle-ops/kr-etf-report-v3.md",
    "/projects/bogle-ops/kr-etf-report-v4.html",
    "/projects/bogle-ops/tiger-fee-latest.md",
    "/projects/bogle-ops/moderation-replies-30.md",
    "/projects/bogle-ops/moderation-replies-50.md",
    "/projects/bogle-ops/onboarding-ab-test.md",
    "/projects/bogle-ops/onboarding-ab-test-pack.md",
    "/projects/bogle-ops/kpi-dashboard-template.md",
    "/projects/bogle-ops/notice-refactor-short-long.md",
    "/projects/bogle-ops/monthly-report-generator-format.md",
    "/projects/bogle-ops/post-quality-check-30s.md",
    "/projects/bogle-ops/threads-humor-pack-001.md",
    "/projects/bogle-ops/tac-playwright-plan.md"
  ],
  "Academy MVP": [
    "/projects/academy-mvp/README.md",
    "/projects/academy-mvp/templates.md",
    "/projects/academy-mvp/quick-commands.md"
  ],
  "Internal Ops": [
    "/projects/internal/WORKQUEUE.md",
    "/projects/internal/HEARTBEAT.md"
  ],
  "Retire Sim": [
    "/projects/retire-sim/README.md",
    "/projects/retire-sim/prd-v1.md",
    "/projects/retire-sim/personas-problems.md",
    "/projects/retire-sim/engine-spec.md",
    "/projects/retire-sim/scenarios-20.md",
    "/projects/retire-sim/data-schema.md",
    "/projects/retire-sim/mvp-priority.md",
    "/projects/retire-sim/architecture.md",
    "/projects/retire-sim/wireframe-text.md",
    "/projects/retire-sim/risk-compliance.md",
    "/projects/retire-sim/ops-policy.md",
    "/projects/retire-sim/dev-backlog.md",
    "/projects/retire-sim/qa-testplan.md"
  ],
  "Service Monetization": [
    "/projects/service-monetization/README.md"
  ]
};

const nav = document.getElementById('nav');
const content = document.getElementById('content');
const toc = document.getElementById('toc');
const meta = document.getElementById('meta');

function baseName(path){ return path.split('/').pop(); }

function renderNav(selected){
  nav.innerHTML = '';
  Object.entries(docs).forEach(([group, files]) => {
    const box = document.createElement('div');
    box.className = 'group';
    const h = document.createElement('h3');
    h.textContent = group;
    box.appendChild(h);
    files.forEach(f => {
      const a = document.createElement('a');
      a.href = `?file=${encodeURIComponent(f)}`;
      a.className = 'file' + (f===selected ? ' active':'');
      a.textContent = baseName(f);
      box.appendChild(a);
    });
    nav.appendChild(box);
  });
}

function buildToc(){
  const headings = [...content.querySelectorAll('h1,h2,h3')];
  if (!headings.length) { toc.style.display='none'; return; }
  toc.style.display='block';
  toc.innerHTML = '<h4>목차</h4>';
  headings.forEach((el, i) => {
    if (!el.id) el.id = `sec-${i}`;
    const a = document.createElement('a');
    a.href = `#${el.id}`;
    a.textContent = (el.tagName==='H2'?'　':'') + (el.tagName==='H3'?'　　':'') + el.textContent;
    toc.appendChild(a);
  });
}

async function loadFile(file){
  renderNav(file);
  meta.innerHTML = `문서: <a href="${file}">${file}</a>`;
  try {
    const res = await fetch(file);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const md = await res.text();
    content.classList.remove('empty');
    content.innerHTML = marked.parse(md);
    buildToc();
    document.title = `${baseName(file)} · 문서 허브`;
  } catch (e) {
    toc.style.display='none';
    content.classList.add('empty');
    content.textContent = '문서를 불러오지 못했습니다: ' + e.message;
  }
}

const params = new URLSearchParams(location.search);
const file = params.get('file') || docs['Bogle Ops'][0];
loadFile(file);
</script>
</body>
</html>
